#include "systicks.h"
#include "stm32f4xx.h"

#define TICK_FREQ_INCREMENT   1u          // amount added to the tick counter each ISR
#define MAX_DELAY             0xFFFFFFFF // largest 32-bit unsigned


volatile uint32_t g_current_tick;
volatile uint32_t g_current_tick_p;  // secondary counter if you want to use it


static inline void tick_increment(void)
{
    g_current_tick   +=TICK_FREQ_INCREMENT;
}



void timebase (void){

	__disable_irq();

	  SysTick->LOAD  = 16000000 - 1U ;                       /* set reload register */
	  SysTick->VAL   = 0UL;                                             /* Load the SysTick Counter Value */
	  SysTick->CTRL  = (1U<<2);
	  SysTick->CTRL  |= (1U<<1);
	  SysTick->CTRL  |= (1U<<0);



	__enable_irq();


}
void SysTick_Handler(void)
{
    tick_increment();
}
